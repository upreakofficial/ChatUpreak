<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="https://upreak.com/images/main_logo.png" type="image/x-icon" height="100%" width="100%">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="css/open-iconic-bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="css/animate.css">
  <link rel="stylesheet" type="text/css" href="css/owl.carousel.min.css">
  <link rel="stylesheet" type="text/css" href="css/owl.theme.default.min.css">
  <link rel="stylesheet" type="text/css" href="css/magnific-popup.css">
  <link rel="stylesheet" type="text/css" href="css/aos.css">
  <link rel="stylesheet" type="text/css" href="css/ionicons.min.css">
  <link rel="stylesheet" type="text/css" href="css/bootstrap-datepicker.css">
  <link rel="stylesheet" type="text/css" href="css/jquery.timepicker.css">
  <link rel="stylesheet" type="text/css" href="css/flaticon.css">
  <link rel="stylesheet" type="text/css" href="css/icomoon.css">
  <title>Upreak - Chatbot</title>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1FB387DPFZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1FB387DPFZ');
</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> 
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
<style>  
  body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      /* background-color: #f1f2f9; */
      overflow: hidden;
      background-image:url('https://images.unsplash.com/photo-1517048676732-d65bc937f952?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');
    background-size: cover;
    background-repeat: no-repeat;
    }
    
    .back{
  
  }

    .chat-container {
      
       /* Limit the chat container width */
      margin: 20px auto;
      
      /* background-color: #e5ddd5; Light grey background color */
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .chat-header {
      padding: 20px;
      text-align: center;
      background-color: #2c6dff; /* WhatsApp blue color */
/*       color: #fff; */
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
    }

    .chat-body {
      padding: 1.5% 2%;
      min-height: 70vh;
      max-height: 70vh; /* Limit the chat body height to 70% of the viewport height */
      overflow-y: auto;
    }
    .chat-body-text {
      padding: 1.5% 2%;
/*       min-height: 60vh;
      max-height: 70vh */
/*       ; Limit the chat body height to 70% of the viewport height */
      overflow-y: auto;
    }

    .chat-message {
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 0px 15px 15px 15px;
/*       display: flex; */
      justify-content: space-between;
    }
    .user-message {
      background-color: #0064e8; /* Light green background color for user messages */
      color: #fff;
      font-weight: 700;
      align-self: flex-end;
      max-width: 70%; /* Adjust the width of user messages */
      margin-left: 30%; /* Move user messages to the right side */
		border-radius: 0px 15px 15px 15px;	
    }

    .chatbot-message {
      background-color: #fff; /* Light grey background color for chatbot messages */
      color: #000;
      align-self: flex-start;
      max-width: 70%; /* Adjust the width of chatbot messages */
      margin-right: 30%; /* Move chatbot messages to the left side */
    }

    @keyframes fadeIn {
      to {
        opacity: 1;
      }
    }

    .chat-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 20px;
      border-top: 1px solid #ccc;
    }

    #user-input {
      flex-grow: 1;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
      margin-left: 12px;
      margin-right: 12px;
    }

    #send-button,
    #skip-button {
      padding: 8px 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      color: #fff;
    }

    #send-button {
      background-color: #2c6dff; /* WhatsApp blue color */
      margin-right: 10px;
    }

    #skip-button {
      background-color: #ccc;
    }

    #skip-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }

    #skip-button:not(:disabled):hover {
      background-color: #888;
    }

/* new sidebar */


.main-div {
  max-width: 800px;
  display: flex;
  margin: auto;
  justify-content: center;
  align-items: center;
  padding: 20px;
}

.logoimg{
  width: 10%;
}
.imgdiv{ 
  text-align: start;
}
/* Media queries for responsiveness */

/* For devices with a maximum width of 768px */
@media only screen and (max-width: 768px) {
  .chat-container {
    width: 90%;
    margin: 10px auto;
  }

  .user-message, .chatbot-message {
    max-width: 80%; /* Adjusted width for smaller screens */
    margin-left: 20%; /* Adjusted margin for smaller screens */
    margin-right: 20%;
  }
  .logoimg{
  width: 20%;
}
.imgdiv{ 
  text-align: center;
}

}

/* For smaller mobile devices with a maximum width of 480px */
@media only screen and (max-width: 480px) {
  .chat-container {
    width: 100%;
    margin: 10px auto;
  }

  .user-message, .chatbot-message {
    max-width: 90%; /* Further adjusted width for smaller screens */
    margin-left: 5%; /* Further adjusted margin for smaller screens */
    margin-right: 5%;
  }
.logoimg{
  width: 30%;
}
.imgdiv{ 
  text-align: center;
}
#user-input {
     width: 25px;
    }

}
.chat-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 5px 15px;
    border-top: 1px solid #ccc;
    margin-bottom: 12px;
}
  </style>
</head>
<body class="back">
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
      <a class="navbar-brand" href="https://upreak.com/">
        <img src="https://upreak.com/images/main_logo.png" alt="Logo"  class="d-inline-block align-top logoimg">
      </a>
     
     
    </div>
  </nav>
  
 
  <!-- main content -->
  <div>
    <div class="main-div">
      <% if (!locals.termsAccepted) { %>
     <!-- Bootstrap modal for terms and conditions -->
     <div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
         <div class="modal-dialog">
             <div class="modal-content">
                 <div class="modal-body">
     <div class="mb-3">
         <a href="https://upreak.com"><img width="20%" src="./../images/main_logo.png"></a>
                    <!-- Terms and conditions content here -->
         </div>            <label>
                           <input type="checkbox" id="acceptTerms"> I accept the terms and conditions
                     </label>
                 </div>
               <!--   <div class="modal-footer"> -->
                     <button type="button" class="btn btn-primary" id="submitTerms">Submit</button>
                <!-- </div> -->
             </div>
         </div>
     </div>
     <% } %>
     <div class="chat-container bg-white">
      <div class="chat-body mb-1 mt-2">
        <div class="chat-body-text chat-message chatbot-message shadow"id="chat-box">
        <!-- Chat messages will be added here dynamically -->
        <p>Hello! I’m Upreak. I’m here to help you find the perfect job for you.<br>Let’s get started!</p>
        </div>
        <div class="chat-body-text chat-message chatbot-message shadow"id="chat-box">
          <p>Make sure to provide the essential information requested below to fulfill the requirements for your ideal job. We encourage you to answer each question thoroughly.</p>
          </div>
      
        <% for (var i = 2; i < chatHistory.length; i++) { %>
          <div class="chat-body-text  <%= chatHistory[i].type %>">
           <% if (chatHistory[i].type == 'response') { %> 
          <div class="chat-message  user-message shadow">
          <% if (chatHistory[i].text.trim() !== '') { %>
            <p><%= chatHistory[i].text %></p>
          <% } else { %>
            <p>You skipped it.</p>
          <% } %>
      <p style="color:red"><%= chatHistory[i].remarks %></p>
            </div>
           <% } %>
   
           <% if (chatHistory[i].type != 'response') { %>
       <div class="chat-message  chatbot-message">
           <p><%= chatHistory[i].text %> <% if (chatHistory[i].important = true ) { %>
      <span style="color:red">*</span><% } %>	</p>
           <% if (chatHistory[i].remarks != "" ) { %>
      <p style="color:red"><%= chatHistory[i].remarks %>
           </p><% } %>
      </div>
          <% }%>
        
          </div>
        <% } %>
   
        <% if (question) { %>
          <div class="chat-body-text">
            <div class="chat-message chatbot-message shadow">
              <p><%= question.question %><% if (question.important == "true") { %>
                <span style="color:red">*</span>
              <% } %></p>
              <% if (question.remarks) { %><p style="color:red">( <%= question.remarks %> )</p><% }%>
              <% if (question.options) { %>
              <% for (var i = 0; i <  question.options.length; i++) { %>
                  <button class="btn btn-sm btn-primary option-button"><%- question.options[i].option %></button>
              <% }%>
            
              <% }%>
   
            </div>
          </div>
        </div>
          <form action="/save_chatbot" method="POST">   
            <div class="chat-footer">
              
              <input type="hidden" name="question_id" value="<%= question.id %>">
              <input type="hidden" name="previous_question" value="<%= chatHistory.length > 0 && (chatHistory[chatHistory.length - 1].type === 'question' ? chatHistory[chatHistory.length - 1].text : '') %>">
              <input type="hidden" name="previous_response" value="<%= chatHistory.length > 0 && (chatHistory[chatHistory.length - 1].type === 'response' ? chatHistory[chatHistory.length - 1].text : '') %>">
              <input type="hidden" name="chat_history" value="<%= JSON.stringify(chatHistory) %>">
              <input type="hidden" name="user_resp" value="<%= JSON.stringify(user_resp) %>">
              <input type="<%= question.type %>" name="response" id="user-input" placeholder="Type your message here..." <%- question.important == 'true' ? 'required' : '' %> <%= question.type == 'tel' ? 'pattern=[0-9]{10}' : '' %> >
              <% if (question.order_id == 16) { %>
                  <button type="submit" id="send-button">Submit</button>
                <% } else { %>
                  <button type="submit" id="send-button">Send</button>
                    <% if (question.important == "false") { %>
                      <button type="submit" id="skip-button">Skip</button>
                    <% } %>
                  <% } %>
            </div> 
          </form>
     
          <% } else { %>
            <div class="chat-body-text">
              <div class="chat-message ">
                  <!-- Chat messages will be added here dynamically --> <p>Chatbot session has ended.</p>
              </div>
            </div>
          <% } %>
     
    </div>
  </div>
  </div>
  <script>
  //  document.addEventListener('DOMContentLoaded', function() {
//     const acceptTermsCheckbox = document.getElementById('acceptTerms');
//     const termsModal = new bootstrap.Modal(document.getElementById('termsModal'), {
//         backdrop: 'static', // This prevents clicking outside the modal to close it
//         keyboard: false // This prevents closing the modal with the escape key
//     });

//     if (!localStorage.getItem('termsAccepted')) {
//         termsModal.show();
//     }

//     document.getElementById('submitTerms').addEventListener('click', function() {
//         if (acceptTermsCheckbox.checked) {
//             localStorage.setItem('termsAccepted', 'true');
//             termsModal.hide();
//         } else {
//             // Display an error message or handle the case where terms are not accepted
//         }
//     });
// });

</script>
<script> document.addEventListener("DOMContentLoaded", function() {
    // Get references to the buttons and the input field
    const optionButtons = document.querySelectorAll(".option-button");
    const userInputField = document.getElementById("user-input");
    const formElement = document.querySelector("form");
    const chatBox = document.querySelector(".chat-body");

    // Function to scroll to the bottom of the chat box
    function scrollToBottom() {
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    // Add click event listener to each button
    optionButtons.forEach(button => {
      button.addEventListener("click", function() {
        // Get the inner text of the clicked button
        const buttonText = button.innerText;

        // Set the value of the input field to the button's inner text
        userInputField.value = buttonText;

        // Automatically submit the form after setting the value
        formElement.submit();

        // Scroll the chat body to the bottom after submitting the form
        scrollToBottom();
      });
    });

    // Scroll the chat body to the bottom when the form is submitted (user input entered)
    formElement.addEventListener("submit", function() {
      scrollToBottom();
    });

    // Initial scroll to the bottom when the page is loaded
    scrollToBottom();
  });
</script>
<script>
// Scroll to the bottom of the page
function scrollToBottom() {
  window.scrollTo(0, document.body.scrollHeight);
}

// Call the scrollToBottom function whenever you need to scroll to the bottom.
scrollToBottom();
</script>
</body>
</html>
